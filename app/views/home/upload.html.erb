<script language="javascript">
HTMLElement.prototype.insertAdjacentHTML=function(where, html)
{
  var e=this.ownerDocument.createRange();
  e.setStartBefore(this);
  e=e.createContextualFragment(html);
  switch (where)
  {
    case 'beforeBegin': this.parentNode.insertBefore(e, this);break;
    case 'afterBegin': this.insertBefore(e, this.firstChild); break;
    case 'beforeEnd': this.appendChild(e); break;
    case 'afterEnd':
      if(!this.nextSibling) this.parentNode.appendChild(e);
      else this.parentNode.insertBefore(e, this.nextSibling); break;
  }
}
$(function () {
  $("#upoadfile_date").val("<%=@image_date%>");
  $("#uploadfile_username").val("<%=@username%>");
  $("#uploadfile_platform").val("<%=@platform%>");
  $("#uploadfile_branch").val("<%=@branch%>");
  $("#uploadfile_device").val("<%=@device%>");
})
function addText()       {
  var i = 1;
    var str ='<input id="file1" name="file[]" size="30" type="file" /><div style="display:none;"><input type="text" id="upoadfile_date" name="upoadfile_date" value="<%=@image_date%>" style="display:none;"></br><input type="text" id="uploadfile_username" name="uploadfile_username" value="<%=@username%>" style="display:none;"></br><input type="text" id="uploadfile_platform" name="uploadfile_platform" value="<%=@platform%>" style="display:none;"></br><input type="text" id="uploadfile_branch" name="uploadfile_branch" value="<%=@branch%>" style="display:none;"></br><input type="text" id="uploadfile_device" name="uploadfile_device" value="<%=@device%>" style="display:none;"></br></div>';
    document.getElementById('MyFile').insertAdjacentHTML("beforeEnd",str);
}
function saveReport(){
  $("#progress").show();
  for(var i=0; i<=100;i++){
    $("#bar").text(i+"%");
    $("#bar").width(i+"%");
  }
  $.ajax({
        type: "GET",
        url:'/home/index',
        success: function(data){
          $("#uploadfiles").hide();
          $("#file_but").show();
        }
    });
}
function cancel(){
  $("#file").val("");
  $("#uploadfiles").hide();
  $("#file_but").show();
}
</script>
<%=form_tag({:action => :index}, {:multipart => true,:id=>"saveReportForm",:onsubmit=>"saveReport()",:target=>"id_iframe"}) do -%>
  <div id="MyFile">
    <div style="display:none;">
      <input type="text" id="upoadfile_date" name="upoadfile_date" ></br>
      <input type="text" id="uploadfile_username" name="uploadfile_username"></br>
      <input type="text" id="uploadfile_platform" name="uploadfile_platform"></br>
      <input type="text" id="uploadfile_branch" name="uploadfile_branch"></br>
      <input type="text" id="uploadfile_device" name="uploadfile_device"></br>
    </div>
  </div>
  <input  id="file" name="file[]" size="30" type="file" />
  <input class="btn" type="button" value="add" onclick="addText()"/>
<%end -%>
<iframe id="id_iframe" name="id_iframe" style="display:none;"></iframe>
<div class="progress progress-striped active" style="display:none;" id="progress">
  <div class="bar" style="width: 0%;" id="bar"></div>
</div>
<span class="icon-caret-down btn" onclick="cancel()" id="cancel" style="font-size: 10px;">Cancel</span>
