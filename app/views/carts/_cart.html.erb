<% @all_purposes = get_distinct_purposes() %>
<% @all_categories = get_distinct_scenario_categories() %>
<%scenario_name_list =[]%>
<%task_id_list=[]%>
<%task_purpose=[]%>
<%count=0%>
<% @all_purposes.each do |purpose| %>
    <% @cart.record_list.each do |record| %>
        <% if get_record_info(record.power_record.id).purpose == purpose %>
            <%scenario_name_list<<get_record_info(record.power_record.id).power_scenario_id%>
            <%task_id_list<<get_record_info(record.power_record.id).task_id%>
        <% end %>
    <% end %>
<% end %>
<div style="text-align: center; background-color:#FFFFFFF;">
    <center>
        <article>
            <ul class="nav nav-tabs" id="compare_scenario_category">
                    <li><a href="#All">All</a></li>
                <% @all_categories.each do |category| %>
                    <li><a href="#<%= category %>"><%= category %></a></li>
                <% end %>
            </ul>
            <div class="tab-content">
                    <div class="tab-pane" id="All">
                        <div id="chart_container_All" style="min-width: 70%; height: 400px; margin: 0 auto">
                        </div>

                            <table class="table table-wuxia" id="compare_tab">
                                <thead>
                                    <tr>
                                        <th>Scenario</th>
                                        <th id ="battery" >Battey</th>
                                        <th id ="vcc_main" >Vcc_main</th>
                                        <th id ="fps" >Fps</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                    <td>
                                        purpose
                                    </td>
                                    <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <%count=count+1%>
                                            <%task_purpose<<getpurpose%>
                                            <td>
                                                <input type="checkbox" name="compare_battery" onclick="cmp_battery()">
                                                    <hr/>
                                                <%=getpurpose.purpose%>
                                            </td>
                                            <%break%>
                                        <%end%>
                                    <%end%>
                                    <td>
                                        Diff
                                    </td>
                                        <%task_id_list.uniq.each do |taskid|%>
                                            <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                            <%@get_task_id_purpose.each do |getpurpose|%>
                                                <td>
                                                    <input type="checkbox" name="compare_vcc_main" onclick="cmp_vcc_main()">
                                                        <hr/>
                                                    <%=getpurpose.purpose%>
                                                </td>
                                                <%break%>
                                            <%end%>
                                        <%end%>
                                    <td>
                                        Diff
                                    </td>
                                        <%task_id_list.uniq.each do |taskid|%>
                                            <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                            <%@get_task_id_purpose.each do |getpurpose|%>
                                                <td>
                                                    <input type="checkbox" name="compare_fps" onclick="cmp_fps()">
                                                        <hr/>
                                                    <%=getpurpose.purpose%>
                                                </td>
                                                <%break%>
                                            <%end%>
                                        <%end%>
                                    <td>
                                        Diff
                                    </td>
                                    </tr>
                                    <tr>
                                        <td>Image_date</td>
                                        <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <td><%=getpurpose.image_date%></td>
                                            <%break%>
                                        <%end%>
                                        <%end%>
                                        <td></td>
                                        <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <td><%=getpurpose.image_date%></td>
                                            <%break%>
                                        <%end%>
                                        <%end%>
                                        <td></td>
                                        <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <td><%=getpurpose.image_date%></td>
                                            <%break%>
                                        <%end%>
                                        <%end%>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td>devices</td>
                                        <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <td><%=getpurpose.device%></td>
                                            <%break%>
                                        <%end%>
                                        <%end%>
                                        <td></td>
                                         <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <td><%=getpurpose.device%></td>
                                            <%break%>
                                        <%end%>
                                        <%end%>
                                        <td></td>
                                         <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <td><%=getpurpose.device%></td>
                                            <%break%>
                                        <%end%>
                                        <%end%>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td>Branch</td>
                                        <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <td><%=getpurpose.branch%></td>
                                            <%break%>
                                        <%end%>
                                        <%end%>
                                        <td></td>
                                        <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <td><%=getpurpose.branch%></td>
                                            <%break%>
                                        <%end%>
                                        <%end%>
                                        <td></td>
                                        <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <td><%=getpurpose.branch%></td>
                                            <%break%>
                                        <%end%>
                                        <%end%>
                                        <td></td>
                                    </tr>

                                    <%scenario_name_list.uniq.each do |snl|%>
                                        <tr>
                                            <td><%=get_scenario_name(snl)%></td>
                                                <%task_purpose.each do |tk_purpose|%>
                                                <td>
                                                    <% @all_purposes.each do |purpose| %>
                                                        <% @cart.record_list.each do |record| %>
                                                                <% if get_record_info(record.power_record.id).purpose == purpose %>
                                                                    <%@get_power_record_result=get_power_record_result(snl,tk_purpose.purpose,record.power_record.id,tk_purpose.image_date)%>
                                                                    <%@get_power_record_result.each do |index_battery|%>
                                                                        <%=index_battery.battery%>
                                                                    <%end%>
                                                                <%end%>
                                                        <%end%>
                                                    <%end%>
                                                </td>
                                                <%end%>
                                            <td></td>
                                            <%task_purpose.each do |tk_purpose|%>
                                                <td>
                                                    <% @all_purposes.each do |purpose| %>
                                                        <% @cart.record_list.each do |record| %>
                                                                <% if get_record_info(record.power_record.id).purpose == purpose %>
                                                                    <%@get_power_record_result=get_power_record_result(snl,tk_purpose.purpose,record.power_record.id,tk_purpose.image_date)%>
                                                                    <%@get_power_record_result.each do |index_battery|%>
                                                                        <%=index_battery.vcc_main%>
                                                                    <%end%>
                                                                <%end%>
                                                        <%end%>
                                                    <%end%>
                                                </td>
                                                <%end%>
                                            <td></td>
                                            <%task_purpose.each do |tk_purpose|%>
                                                <td>
                                                    <% @all_purposes.each do |purpose| %>
                                                        <% @cart.record_list.each do |record| %>
                                                                <% if get_record_info(record.power_record.id).purpose == purpose %>
                                                                    <%@get_power_record_result=get_power_record_result(snl,tk_purpose.purpose,record.power_record.id,tk_purpose.image_date)%>
                                                                    <%@get_power_record_result.each do |index_battery|%>
                                                                        <%=index_battery.fps%>
                                                                    <%end%>
                                                                <%end%>
                                                        <%end%>
                                                    <%end%>
                                                </td>
                                                <%end%>
                                            <td></td>
                                        </tr>
                                    <%end%>
                            </tbody>
                        </table>
                        <footer id="footer">
                            <div id="compare_list" ></div>
                         </footer>
                    </div>
                    <% @all_categories.each do |category| %>
                    <div class="tab-pane" id="<%= category %>">
                        <div id="chart_container<%= category %>" style="min-width: 70%; height: 400px; margin: 0 auto">
                        </div>

                        <table class="table table-wuxia" id ="table_<%=category%>">
                            <thead>
                                <tr>
                                        <th>Scenario</th>
                                        <th id ="battery_<%=category%>" >Battey</th>
                                        <th id ="vcc_main_<%=category%>" >Vcc_main</th>
                                        <th id ="fps_<%=category%>" >Fps</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                            <hr/>
                                    purpose
                                    </td>
                                    <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <td>
                                                <input type="checkbox" name="compare_battery_<%=category%>" onclick="cmp_battery_<%=category%>()">
                                                        <hr/>
                                                    <%=getpurpose.purpose%>
                                            </td>
                                            <%break%>
                                        <%end%>
                                        <%end%>
                                        <td>
                                            <hr/>
                                        Diff
                                    </td>
                                        <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <td>
                                                <input type="checkbox" name="compare_vcc_main_<%=category%>" onclick="cmp_vcc_main_<%=category%>()">
                                                        <hr/>
                                                    <%=getpurpose.purpose%>
                                            </td>
                                            <%break%>
                                        <%end%>
                                        <%end%>
                                        <td>
                                            <hr/>
                                        Diff
                                    </td>
                                        <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <td>
                                                <input type="checkbox" name="compare_fps_<%=category%>" onclick="cmp_fps_<%=category%>()">
                                                        <hr/>
                                                    <%=getpurpose.purpose%>
                                            </td>
                                            <%break%>
                                        <%end%>
                                        <%end%>
                                        <td>
                                            <hr/>
                                        Diff
                                    </td>
                                    </tr>
                                    <tr>
                                        <td>Image_date</td>
                                        <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <td><%=getpurpose.image_date%></td>
                                            <%break%>
                                        <%end%>
                                        <%end%>
                                        <td></td>
                                        <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <td><%=getpurpose.image_date%></td>
                                            <%break%>
                                        <%end%>
                                        <%end%>
                                        <td></td>
                                        <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <td><%=getpurpose.image_date%></td>
                                            <%break%>
                                        <%end%>
                                        <%end%>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td>devices</td>
                                        <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <td><%=getpurpose.device%></td>
                                            <%break%>
                                        <%end%>
                                        <%end%>
                                        <td></td>
                                         <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <td><%=getpurpose.device%></td>
                                            <%break%>
                                        <%end%>
                                        <%end%>
                                        <td></td>
                                         <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <td><%=getpurpose.device%></td>
                                            <%break%>
                                        <%end%>
                                        <%end%>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td>Branch</td>
                                        <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <td><%=getpurpose.branch%></td>
                                            <%break%>
                                        <%end%>
                                        <%end%>
                                        <td></td>
                                        <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <td><%=getpurpose.branch%></td>
                                            <%break%>
                                        <%end%>
                                        <%end%>
                                        <td></td>
                                        <%task_id_list.uniq.each do |taskid|%>
                                        <%@get_task_id_purpose=get_task_id_purpose(taskid)%>
                                        <%@get_task_id_purpose.each do |getpurpose|%>
                                            <td><%=getpurpose.branch%></td>
                                            <%break%>
                                        <%end%>
                                        <%end%>
                                        <td></td>
                                    </tr>
                                <%scenario_name_list.uniq.each do |snl|%>
                                    <%if get_scenario_name_category(get_scenario_name(snl))==category%>
                                        <tr>
                                            <td><%=get_scenario_name(snl)%></td>
                                             <%task_purpose.each do |tk_purpose|%>
                                                <td>
                                                    <% @all_purposes.each do |purpose| %>
                                                        <% @cart.record_list.each do |record| %>
                                                                <% if get_record_info(record.power_record.id).purpose == purpose %>
                                                                    <%@get_power_record_result=get_power_record_result(snl,tk_purpose.purpose,record.power_record.id,tk_purpose.image_date)%>
                                                                    <%@get_power_record_result.each do |index_battery|%>
                                                                        <%=index_battery.battery%>
                                                                    <%end%>
                                                                <%end%>
                                                        <%end%>
                                                    <%end%>
                                                </td>
                                                <%end%>
                                            <td></td>
                                           <%task_purpose.each do |tk_purpose|%>
                                                <td>
                                                    <% @all_purposes.each do |purpose| %>
                                                        <% @cart.record_list.each do |record| %>
                                                                <% if get_record_info(record.power_record.id).purpose == purpose %>
                                                                    <%@get_power_record_result=get_power_record_result(snl,tk_purpose.purpose,record.power_record.id,tk_purpose.image_date)%>
                                                                    <%@get_power_record_result.each do |index_battery|%>
                                                                        <%=index_battery.vcc_main%>
                                                                    <%end%>
                                                                <%end%>
                                                        <%end%>
                                                    <%end%>
                                                </td>
                                                <%end%>
                                            <td></td>
                                           <%task_purpose.each do |tk_purpose|%>
                                                <td>
                                                    <% @all_purposes.each do |purpose| %>
                                                        <% @cart.record_list.each do |record| %>
                                                                <% if get_record_info(record.power_record.id).purpose == purpose %>
                                                                    <%@get_power_record_result=get_power_record_result(snl,tk_purpose.purpose,record.power_record.id,tk_purpose.image_date)%>
                                                                    <%@get_power_record_result.each do |index_battery|%>
                                                                        <%=index_battery.fps%>
                                                                    <%end%>
                                                                <%end%>
                                                        <%end%>
                                                    <%end%>
                                                </td>
                                                <%end%>
                                            <td></td>
                                        </tr>
                                    <%end%>
                                <%end%>
                            </tbody>
                        </table>
                        </div>
                    <% end %>
            </div>
        </article>
    </center>
</div>

<script>

$(function () {
    $('#chart_container_All').highcharts({
        chart: {
             type: 'column'
         },
        title: {
            text: ''
        },
        xAxis: {
            categories: [
                <% @cart.record_list.each do |record| %>
                    '<%= get_scenario_name(record.power_record.power_scenario_id) %>',
                <% end %>
            ]
        },
        yAxis: {
            min: 5,
            title: {
             text: 'power'
            }
        },
         tooltip: {
            headerFormat: '<span style="font-size:12px">{point.key}</span><table>',
            pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                '<td style="padding:0"><b>{point.y:.1f} mA</b></td></tr>',
                footerFormat: '</table>',
                shared: true,
                useHTML: true
        },
        plotOptions: {
            column: {
            pointPadding: 0.2,
            borderWidth: 0
            },
            series: {
               cursor: 'pointer',
               events: {
                click: function show_dc(battery){
                        var point_y =battery.point.y;
                        var task_url = "get_dc?battery=" + point_y;
                        $.ajax({
                            type: "GET",
                            url: task_url,
                            success: function(msg){
                                $("footer").css("display","block");
                                $("#dc_info").append(msg);
                                $("#" + battery).resizable();
                            }
                        });
                    }
              }
         }
        },
        series: [
            <% @all_purposes.each do |purpose| %>
                {
                    name: '<%= purpose %>',
                    data: [
                        <% @cart.record_list.each do |record| %>
                            <% if get_record_info(record.power_record.id).purpose == purpose %>
                                <%= get_record_info(record.power_record.id).battery.to_f %>,
                            <% end %>
                        <% end %>
                    ]
                },
            <% end %>
            ]
        });
});

<% @all_categories.each do |category| %>
$(function () {
    $('#chart_container<%= category %>').highcharts({
        chart: {
             type: 'column'
         },
        title: {
            text: ''
        },
        xAxis: {
            categories: [
                <% @cart.record_list.each do |record| %>
                    <% if get_scenario_category(record.power_record.power_scenario_id) == category %>
                    '<%= get_scenario_name(record.power_record.power_scenario_id) %>',
                    <% end %>
                <% end %>
            ]
        },
        yAxis: {
            min: 5,
            title: {
             text: 'power'
            }
        },
         tooltip: {
            headerFormat: '<span style="font-size:12px">{point.key}</span><table>',
            pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                '<td style="padding:0"><b>{point.y:.1f} mA</b></td></tr>',
                footerFormat: '</table>',
                shared: true,
                useHTML: true
        },
        plotOptions: {
            column: {
            pointPadding: 0.2,
            borderWidth: 0
            },
            series: {
               cursor: 'pointer',
               events: {
                click: function show_dc(battery){
                        var point_y =battery.point.y;
                        var task_url = "get_dc?battery=" + point_y;
                        $.ajax({
                            type: "GET",
                            url: task_url,
                            success: function(msg){
                                $("footer").css("display","block");
                                $("#dc_info").append(msg);
                                $("#" + battery).resizable();
                            }
                        });
                    }
              }
         }
        },
        series: [
            <% @all_purposes.each do |purpose| %>
                {
                    name: '<%= purpose %>',
                    data: [
                        <% @cart.record_list.each do |record| %>
                            <% if get_scenario_category(record.power_record.power_scenario_id) == category %>
                                <% if get_record_info(record.power_record.id).purpose == purpose %>
                                    <%= get_record_info(record.power_record.id).battery.to_f %>,
                                <% end %>
                            <% end %>
                        <% end %>
                    ]
                },
            <% end %>
            ]
        });
});
<% end %>

$(function () {
        $('#compare_scenario_category a:first').tab('show');
        $('#compare_scenario_category a').click(function (e){
            e.preventDefault();
          $(this).tab('show');
        })
})

function nTabs(thisObj, Num) {
    if (thisObj.className == "active")
        return;
    var tabObj = thisObj.parentNode.id;
    var tabList = document.getElementById(tabObj)
            .getElementsByTagName("li");
    for (i = 0; i < tabList.length; i++) {
        if (i == Num) {
            thisObj.className = "active";
            document.getElementById(tabObj + "_container" + i).style.display = "block";

        } else {
            tabList[i].className = "normal";
            document.getElementById(tabObj + "_container" + i).style.display = "none";

        }
    }
}
$(function(){
    var th_span=<%=count%>
    document.getElementById('battery').setAttribute("colspan",1+th_span);
    document.getElementById('vcc_main').setAttribute("colspan",1+th_span);
    document.getElementById('fps').setAttribute("colspan",1+th_span);
});
function cmp_battery(){
    var inputs = document.getElementsByName("compare_battery");
    var gettd=document.getElementById("compare_tab");
    var tab_count=<%=count%>;
    var battery_list =new Array();
    var com_battery=new Array();
    var checked_counts = 0;
    for(var i=0;i<inputs.length;i++){
        if(inputs[i].checked){
            for(var j=2;j<gettd.rows.length;j++){
            var battery_col= gettd.rows[j].cells[i+1].innerText;
            battery_list.push(battery_col);
        }
            checked_counts++;
            if(checked_counts>2){
                alert("Is not greater than 2!");
                inputs[i].checked=false;
            }
        }
    }
    for(var i=0;i<battery_list.length/2;i++){
         com_battery.push(battery_list[i]-battery_list[battery_list.length/2+i]);
    }
    if(checked_counts==2){
        for(var j=2;j<gettd.rows.length;j++){
        gettd.rows[j].cells[inputs.length+1].innerText=com_battery[j-2];
    }
    }

}
function cmp_vcc_main(){
    var inputs = document.getElementsByName("compare_vcc_main");
    var gettd=document.getElementById("compare_tab");
    var tab_count=<%=count%>;
    var vcc_main_list=new Array();
    var com_vcc_main=new Array();
    var checked_counts = 0;
    for(var i=0;i<inputs.length;i++){
        if(inputs[i].checked){
            for(var j=2;j<gettd.rows.length;j++){
            var vcc_main_col=gettd.rows[j].cells[i+tab_count+2].innerText;
            vcc_main_list.push(vcc_main_col);
        }
            checked_counts++;
            if(checked_counts>2){
                alert("Is not greater than 2!");
                inputs[i].checked=false;
            }
        }
    }
    for(var i=0;i<vcc_main_list.length/2;i++){
         com_vcc_main.push(vcc_main_list[i]-vcc_main_list[vcc_main_list.length/2+i]);
    }
    if(checked_counts==2){
        for(var j=2;j<gettd.rows.length;j++){
        gettd.rows[j].cells[inputs.length+tab_count+2].innerText=com_vcc_main[j-2];
    }
    }

}
function cmp_fps(){
    var inputs = document.getElementsByName("compare_fps");
    var gettd=document.getElementById("compare_tab");
    var tab_count=<%=count%>;
    var fps_list =new Array();
    var com_fps=new Array();
    var checked_counts = 0;
    for(var i=0;i<inputs.length;i++){
        if(inputs[i].checked){
            for(var j=2;j<gettd.rows.length;j++){
            var fps_col=gettd.rows[j].cells[i+(tab_count+1)*2+1].innerText;
            fps_list.push(fps_col);
        }
            checked_counts++;
            if(checked_counts>2){
                alert("Is not greater than 2!");
                inputs[i].checked=false;
            }
        }
    }
    for(var i=0;i<fps_list.length/2;i++){
         com_fps.push(fps_list[i]-fps_list[fps_list.length/2+i]);
    }
    if(checked_counts==2){
        for(var j=2;j<gettd.rows.length;j++){
        gettd.rows[j].cells[inputs.length+tab_count*2+3].innerText=com_fps[j-2];
    }
    }

}
<% @all_categories.each do |category| %>
$(function(){
    var th_span=<%=count%>
    document.getElementById('battery_<%=category%>').setAttribute("colspan",1+th_span);
    document.getElementById('vcc_main_<%=category%>').setAttribute("colspan",1+th_span);
    document.getElementById('fps_<%=category%>').setAttribute("colspan",1+th_span);
});
function cmp_battery_<%=category%>(){
    var inputs = document.getElementsByName("compare_battery_<%=category%>");
    var gettd=document.getElementById("table_<%=category%>");
    var tab_count=<%=count%>;
    var battery_list =new Array();
    var com_battery=new Array();
    var checked_counts = 0;
    for(var i=0;i<inputs.length;i++){
        if(inputs[i].checked){
            for(var j=2;j<gettd.rows.length;j++){
            var battery_col= gettd.rows[j].cells[i+1].innerText;
            battery_list.push(battery_col);
        }
            checked_counts++;
            if(checked_counts>2){
                alert("Is not greater than 2!");
                inputs[i].checked=false;
            }
        }
    }
    for(var i=0;i<battery_list.length/2;i++){
         com_battery.push(battery_list[i]-battery_list[battery_list.length/2+i]);
    }
    if(checked_counts==2){
        for(var j=2;j<gettd.rows.length;j++){
        gettd.rows[j].cells[inputs.length+1].innerText=com_battery[j-2];
    }
    }

}
function cmp_vcc_main_<%=category%>(){
    var inputs = document.getElementsByName("compare_vcc_main_<%=category%>");
    var gettd=document.getElementById("table_<%=category%>");
    var tab_count=<%=count%>;
    var vcc_main_list=new Array();
    var com_vcc_main=new Array();
    var checked_counts = 0;
    for(var i=0;i<inputs.length;i++){
        if(inputs[i].checked){
            for(var j=2;j<gettd.rows.length;j++){
            var vcc_main_col=gettd.rows[j].cells[i+tab_count+2].innerText;
            vcc_main_list.push(vcc_main_col);
        }
            checked_counts++;
            if(checked_counts>2){
                alert("Is not greater than 2!");
                inputs[i].checked=false;
            }
        }
    }
    for(var i=0;i<vcc_main_list.length/2;i++){
         com_vcc_main.push(vcc_main_list[i]-vcc_main_list[vcc_main_list.length/2+i]);
    }
    if(checked_counts==2){
        for(var j=2;j<gettd.rows.length;j++){
        gettd.rows[j].cells[inputs.length+tab_count+2].innerText=com_vcc_main[j-2];
    }
    }

}
function cmp_fps_<%=category%>(){
    var inputs = document.getElementsByName("compare_fps_<%=category%>");
    var gettd=document.getElementById("table_<%=category%>");
    var tab_count=<%=count%>;
    var fps_list =new Array();
    var com_fps=new Array();
    var checked_counts = 0;
    for(var i=0;i<inputs.length;i++){
        if(inputs[i].checked){
            for(var j=2;j<gettd.rows.length;j++){
            var fps_col=gettd.rows[j].cells[i+(tab_count+1)*2+1].innerText;
            fps_list.push(fps_col);
        }
            checked_counts++;
            if(checked_counts>2){
                alert("Is not greater than 2!");
                inputs[i].checked=false;
            }
        }
    }
    for(var i=0;i<fps_list.length/2;i++){
         com_fps.push(fps_list[i]-fps_list[fps_list.length/2+i]);
    }
    if(checked_counts==2){
        for(var j=2;j<gettd.rows.length;j++){
        gettd.rows[j].cells[inputs.length+tab_count*2+3].innerText=com_fps[j-2];
    }
    }

}
<%end%>
</script>
