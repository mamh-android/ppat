<?xml version="1.0"?>

<project name="power_camcorder_record" basedir="." default="result">
    <include file="${user.dir}/config/command.xml"/>

    <target name="run">
        <echo message="cleaning ..."/>
        <AdbCmd cmd="adb shell am force-stop com.android.camera2"/>
        <AdbCmd cmd="adb shell rm -rf /data/data/com.android.camera2/cache/"/>
        <AdbCmd cmd="adb shell rm -rf /data/data/com.android.camera2/shared_prefs/"/>
        <echo message="launch camera ..."/>
        <AdbCmd cmd="adb shell am start -n com.android.camera2/com.android.camera.CameraLauncher"/>
        <sleep seconds="10"/>
        <AdbCmd cmd="adb shell sendevent /${storage}/start_camcorder.evt"/>
        <echo message="start tc08 cap..."/>
        <RemoteHostCmd server="${power_server}" sleep="false" sample_t="350" file="usb_tc08.log" cmd="usb_tc08.exe usb_tc08.log 500 1 3 AZ810/370 600"/>
        <echo message="start Soc temp cap..."/>
        <HostCmd cmd="./resource/bin/camcorder_1080p_OV13850.sh ${adb_device_id} ${storage}" workingDirectory="${basedir}"/>
    </target>

    <target name="result" depends="run">
        <echo message="back up thermal file"/>
        <HostCmd cmd="mv temperature.log ${subcase_root}" workingDirectory="${basedir}"/>
        <copy file="${PT4_SERVER}/usb_tc08.log" todir="${subcase_root}" failonerror="false"/>
        <SyncThermalToDB/>
    </target>

</project>
