<?xml version="1.0"?>

<project name="thermal_case" basedir="." default="run">
    <include file="${user.dir}/config/command.xml"/>
    <taskdef resource="net/sf/antcontrib/antcontrib.properties"/>
    <taskdef resource="net/sf/antcontrib/antlib.xml"/>

    <target name="run">
        <Print message="check whether temperature is below 40degC"/>
        <HostCmd cmd="./../../../resource/bin/prepare_temp.sh ${adb_device_id}" workingDirectory="${basedir}" exitValue="value"/>
        <echo message="return value : ${value}"/>
        <if>
            <equals arg1="${value}" arg2="0"/>
            <then>
                <echo message="OK"/>
            </then>
            <else>
                <echo message="Warning: Temp is still higher than 40degC! Exit!"/>
                <SystemExit exitCode="1"/>
            </else>
        </if>

        <AdbCmd cmd="adb install -r ../resource/apk/mobilevideo_4.0.6.4.apk"/>
        <AdbCmd cmd="adb install -r ../resource/apk/WifiTest.apk"/>
        <AdbCmd cmd="adb shell sync"/>
        <AdbCmd cmd="adb push resource/event/${resolution}/start_download.evt /${storage}/"/>
        <UpdateEvent name="${input_device_name}"/>
        <AdbCmd cmd="adb shell busybox sed -i 's/event[0-9]/event${InputEvent}/g' /${storage}/*.evt"/>

    </target>
</project>
