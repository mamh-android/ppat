<?xml version="1.0"?>

<project name="case_thermal" basedir="." default="run">
    <include file="${user.dir}/config/command.xml"/>
    <taskdef resource="net/sf/antcontrib/antcontrib.properties"/>
    <taskdef resource="net/sf/antcontrib/antlib.xml"/>

    <target name="run">
        <Print message="check whether temperature is below 40degC"/>
        <HostCmd cmd="./../resource/bin/prepare_temp.sh ${adb_device_id}" workingDirectory="${basedir}" exitValue="value"/>
        <echo message="return value : ${value}"/>
        <if>
            <equals arg1="${value}" arg2="0"/>
            <then>
                <echo message="OK"/>
            </then>
            <else>
                <echo message="Warning: Temp is still higher than 40degC! Exit!"/>
                <SystemExit exitCode="1"/>
            </else>
        </if>

        <echo message="push cpueater"/>
        <if>
            <contains string="${os_version}" substring="kk"/>
            <then>
                <AdbCmd cmd="adb push resource/bin/cpueater_kk /system/bin/cpueater"/>
            </then>
            <else>
                <AdbCmd cmd="adb push resource/bin/cpueater_lp_32bit /system/bin/cpueater"/>
            </else>
        </if>
        <echo message="push launch file"/>
        <AdbCmd cmd="adb push resource/bin/cpueater_launch.sh /system/bin/"/>

    </target>

</project>
